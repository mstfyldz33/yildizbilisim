import{d as s,j as a}from"./index-CStbfY1k.js";import{r as e}from"./react-vendor-CCsTzcwv.js";import{q as i,h as n,l as d,j as c,x as l,p as m,v as r}from"./firebase-vendor-BOy9xtg7.js";const t=()=>{const[t,j]=e.useState([]),[h,o]=e.useState(!0),[x,p]=e.useState(null);e.useEffect(()=>{f()},[]);const f=async()=>{try{const a=i(n(s,"contact_messages"),d("created_at","desc")),e=(await c(a)).docs.map(s=>({id:s.id,...s.data()}));j(e)}catch(a){}finally{o(!1)}};if(h)return a.jsxs("div",{className:"admin-loading",children:[a.jsx("i",{className:"fas fa-spinner fa-spin"}),a.jsx("p",{children:"Yükleniyor..."})]});const g=t.filter(s=>!s.read).length;return a.jsxs("div",{className:"admin-messages",children:[a.jsx("div",{className:"admin-page-header",children:a.jsxs("div",{children:[a.jsx("h1",{children:"İletişim Mesajları"}),g>0&&a.jsxs("span",{className:"admin-badge-new",children:[g," yeni mesaj"]})]})}),a.jsxs("div",{className:"admin-messages-container",children:[a.jsx("div",{className:"admin-messages-list",children:0===t.length?a.jsxs("div",{className:"admin-empty-state",children:[a.jsx("i",{className:"fas fa-inbox"}),a.jsx("p",{children:"Henüz mesaj yok"})]}):t.map(e=>{var i;return a.jsxs("div",{className:`admin-message-item ${e.read?"":"unread"} ${(null==x?void 0:x.id)===e.id?"active":""}`,onClick:()=>{p(e),e.read||(async a=>{try{await l(m(s,"contact_messages",a),{read:!0}),f()}catch(e){}})(e.id)},children:[a.jsxs("div",{className:"admin-message-header",children:[a.jsxs("div",{children:[a.jsx("strong",{children:e.name}),a.jsx("span",{className:"admin-message-date",children:new Date(e.created_at).toLocaleDateString("tr-TR")})]}),!e.read&&a.jsx("span",{className:"admin-unread-dot"})]}),a.jsxs("p",{className:"admin-message-preview",children:[null==(i=e.message)?void 0:i.substring(0,60),"..."]}),a.jsxs("div",{className:"admin-message-contact",children:[a.jsxs("span",{children:[a.jsx("i",{className:"fas fa-envelope"})," ",e.email]}),a.jsxs("span",{children:[a.jsx("i",{className:"fas fa-phone"})," ",e.phone]})]})]},e.id)})}),x&&a.jsxs("div",{className:"admin-message-detail",children:[a.jsxs("div",{className:"admin-message-detail-header",children:[a.jsxs("div",{children:[a.jsx("h2",{children:x.name}),a.jsxs("p",{className:"admin-message-meta",children:[a.jsxs("span",{children:[a.jsx("i",{className:"fas fa-envelope"})," ",x.email]}),a.jsxs("span",{children:[a.jsx("i",{className:"fas fa-phone"})," ",x.phone]}),a.jsxs("span",{children:[a.jsx("i",{className:"fas fa-calendar"})," ",new Date(x.created_at).toLocaleString("tr-TR")]})]})]}),a.jsxs("button",{onClick:()=>(async a=>{if(confirm("Bu mesajı silmek istediğinizden emin misiniz?"))try{await r(m(s,"contact_messages",a)),f(),(null==x?void 0:x.id)===a&&p(null)}catch(e){alert("Hata: "+e.message)}})(x.id),className:"admin-btn-delete",children:[a.jsx("i",{className:"fas fa-trash"})," Sil"]})]}),a.jsx("div",{className:"admin-message-content",children:a.jsx("p",{children:x.message})})]})]})]})};export{t as default};

import{d as e,j as a,s}from"./index-DuKwbuAV.js";import{r as i}from"./react-vendor-CCsTzcwv.js";import{q as l,h as t,l as n,j as r,v as d,p as c,e as m,x as o,f as u,r as j,y as h,u as x,n as p}from"./firebase-vendor-BOy9xtg7.js";const g=()=>{const[g,f]=i.useState([]),[y,v]=i.useState(!0),[N,b]=i.useState(!1),[k,C]=i.useState(null),[w,S]=i.useState({title:"",description:"",badge:"Kurumsal",icon:"fa-building",location:"",year:(new Date).getFullYear().toString(),features:[],status:"active",gallery_images:[]}),[_,z]=i.useState({icon:"fa-video",text:""}),[A,P]=i.useState(!1);i.useEffect(()=>{K()},[]);const K=async()=>{try{const a=l(t(e,"projects"),n("created_at","desc")),s=(await r(a)).docs.map(e=>({id:e.id,...e.data()}));f(s)}catch(a){}finally{v(!1)}},D=()=>{_.text.trim()&&(S({...w,features:[...w.features,_]}),z({icon:"fa-video",text:""}))},Y=()=>{S({title:"",description:"",badge:"Kurumsal",icon:"fa-building",location:"",year:(new Date).getFullYear().toString(),features:[],status:"active",gallery_images:[]})};return y?a.jsxs("div",{className:"admin-loading",children:[a.jsx("i",{className:"fas fa-spinner fa-spin"}),a.jsx("p",{children:"Yükleniyor..."})]}):a.jsxs("div",{className:"admin-projects",children:[a.jsxs("div",{className:"admin-page-header",children:[a.jsx("h1",{children:"Proje Yönetimi"}),a.jsxs("button",{onClick:()=>{C(null),Y(),b(!0)},className:"admin-btn-primary",children:[a.jsx("i",{className:"fas fa-plus"})," Yeni Proje"]})]}),a.jsx("div",{className:"admin-table-container",children:a.jsxs("table",{className:"admin-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Proje Adı"}),a.jsx("th",{children:"Konum"}),a.jsx("th",{children:"Yıl"}),a.jsx("th",{children:"Badge"}),a.jsx("th",{children:"Durum"}),a.jsx("th",{children:"İşlemler"})]})}),a.jsx("tbody",{children:0===g.length?a.jsx("tr",{children:a.jsx("td",{colSpan:"6",className:"admin-empty",children:"Henüz proje yok. İlk projenizi ekleyin!"})}):g.map(s=>a.jsxs("tr",{children:[a.jsx("td",{children:s.title}),a.jsx("td",{children:s.location}),a.jsx("td",{children:s.year}),a.jsx("td",{children:a.jsx("span",{className:"admin-badge",children:s.badge})}),a.jsx("td",{children:a.jsx("span",{className:"admin-status "+("completed"===s.status?"completed":"active"),children:"completed"===s.status?"Sonlandırıldı":"Aktif"})}),a.jsx("td",{children:a.jsxs("div",{className:"admin-actions",children:[a.jsxs("button",{onClick:()=>(e=>{C(e),S({...e,features:Array.isArray(e.features)?e.features:[],gallery_images:Array.isArray(e.gallery_images)?e.gallery_images:[],status:e.status||"active"}),b(!0)})(s),className:"admin-btn-edit",children:[a.jsx("i",{className:"fas fa-pen-to-square"})," Düzenle"]}),a.jsxs("button",{onClick:()=>(async a=>{if(confirm("Bu projeyi silmek istediğinizden emin misiniz?"))try{await d(c(e,"projects",a)),K()}catch(s){alert("Hata: "+s.message)}})(s.id),className:"admin-btn-delete",children:[a.jsx("i",{className:"fas fa-trash"})," Sil"]})]})})]},s.id))})]})}),N&&a.jsx("div",{className:"admin-modal-overlay",onClick:()=>b(!1),children:a.jsxs("div",{className:"admin-modal admin-modal-large",onClick:e=>e.stopPropagation(),children:[a.jsxs("div",{className:"admin-modal-header",children:[a.jsx("h2",{children:k?"Proje Düzenle":"Yeni Proje"}),a.jsx("button",{onClick:()=>b(!1),className:"admin-modal-close",children:a.jsx("i",{className:"fas fa-times"})})]}),a.jsxs("form",{onSubmit:async a=>{a.preventDefault();try{const a={...w,features:w.features,gallery_images:w.gallery_images,created_at:k?void 0:m(),updated_at:m()};k?await o(c(e,"projects",k.id),a):await u(t(e,"projects"),a),b(!1),C(null),Y(),K()}catch(s){alert("Hata: "+s.message)}},className:"admin-modal-form",children:[a.jsxs("div",{className:"admin-form-group",children:[a.jsx("label",{children:"Proje Adı *"}),a.jsx("input",{type:"text",value:w.title,onChange:e=>S({...w,title:e.target.value}),required:!0})]}),a.jsxs("div",{className:"admin-form-group",children:[a.jsx("label",{children:"Açıklama *"}),a.jsx("textarea",{value:w.description,onChange:e=>S({...w,description:e.target.value}),rows:"4",required:!0})]}),a.jsxs("div",{className:"admin-form-row",children:[a.jsxs("div",{className:"admin-form-group",children:[a.jsx("label",{children:"Konum *"}),a.jsx("input",{type:"text",value:w.location,onChange:e=>S({...w,location:e.target.value}),required:!0})]}),a.jsxs("div",{className:"admin-form-group",children:[a.jsx("label",{children:"Yıl *"}),a.jsx("input",{type:"text",value:w.year,onChange:e=>S({...w,year:e.target.value}),required:!0})]})]}),a.jsxs("div",{className:"admin-form-row",children:[a.jsxs("div",{className:"admin-form-group",children:[a.jsx("label",{children:"Badge *"}),a.jsxs("select",{value:w.badge,onChange:e=>S({...w,badge:e.target.value}),required:!0,children:[a.jsx("option",{value:"Kurumsal",children:"Kurumsal"}),a.jsx("option",{value:"Konut Sitesi",children:"Konut Sitesi"}),a.jsx("option",{value:"Mağaza",children:"Mağaza"})]})]}),a.jsxs("div",{className:"admin-form-group",children:[a.jsx("label",{children:"İkon (Font Awesome class)"}),a.jsx("input",{type:"text",value:w.icon,onChange:e=>S({...w,icon:e.target.value}),placeholder:"fa-building"})]})]}),a.jsxs("div",{className:"admin-form-group",children:[a.jsx("label",{children:"Özellikler"}),a.jsxs("div",{className:"admin-features-list",children:[w.features.map((e,s)=>a.jsxs("div",{className:"admin-feature-item",children:[a.jsx("i",{className:`fas ${e.icon}`}),a.jsx("span",{children:e.text}),a.jsx("button",{type:"button",onClick:()=>(e=>{S({...w,features:w.features.filter((a,s)=>s!==e)})})(s),className:"admin-feature-remove",children:a.jsx("i",{className:"fas fa-times"})})]},s)),a.jsxs("div",{className:"admin-feature-add",children:[a.jsx("input",{type:"text",placeholder:"İkon (örn: fa-video)",value:_.icon,onChange:e=>z({..._,icon:e.target.value}),style:{width:"150px"}}),a.jsx("input",{type:"text",placeholder:"Özellik metni",value:_.text,onChange:e=>z({..._,text:e.target.value}),onKeyPress:e=>"Enter"===e.key&&(e.preventDefault(),D()),style:{flex:1}}),a.jsx("button",{type:"button",onClick:D,className:"admin-btn-small",children:a.jsx("i",{className:"fas fa-plus"})})]})]})]}),a.jsx("div",{className:"admin-form-row",children:a.jsxs("div",{className:"admin-form-group",children:[a.jsx("label",{children:"Durum *"}),a.jsxs("select",{value:w.status,onChange:e=>S({...w,status:e.target.value}),required:!0,children:[a.jsx("option",{value:"active",children:"Aktif"}),a.jsx("option",{value:"completed",children:"Sonlandırıldı"})]})]})}),a.jsxs("div",{className:"admin-form-group",children:[a.jsx("label",{children:"Proje Galeri Resimleri"}),w.gallery_images.length>0&&a.jsx("div",{className:"admin-gallery-preview",children:w.gallery_images.map((e,i)=>a.jsxs("div",{className:"admin-gallery-item",children:[a.jsx("img",{src:e,alt:`Proje ${i+1}`}),a.jsx("button",{type:"button",onClick:()=>(async(e,a)=>{if(confirm("Bu resmi silmek istediğinizden emin misiniz?"))try{const i=e.split("/"),l=i.slice(i.indexOf("o")+1).join("/"),t=decodeURIComponent(l.split("?")[0]),n=j(s,t);await h(n),S({...w,gallery_images:w.gallery_images.filter((e,s)=>s!==a)})}catch(i){}})(e,i),className:"admin-gallery-remove",children:a.jsx("i",{className:"fas fa-times"})})]},i))}),a.jsxs("div",{className:"admin-upload-area",children:[a.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:async e=>{const a=Array.from(e.target.files);if(0!==a.length){P(!0);try{const e=a.map(async e=>{if(!e.type.startsWith("image/"))throw new Error(`${e.name} bir resim dosyası değil!`);const a=e.name.split(".").pop(),i=`${Date.now()}_${Math.random().toString(36).substring(7)}.${a}`,l=`images/projects/${w.title||"project"}_${i}`,t=j(s,l);await x(t,e);return await p(t)}),i=await Promise.all(e);S({...w,gallery_images:[...w.gallery_images,...i]})}catch(i){alert("Resim yüklenirken hata oluştu: "+i.message)}finally{P(!1)}}},disabled:A,className:"admin-file-input"}),A&&a.jsxs("div",{className:"admin-upload-status",children:[a.jsx("i",{className:"fas fa-spinner fa-spin"})," Yükleniyor..."]}),a.jsx("p",{style:{marginTop:"0.5rem",color:"#64748b",fontSize:"0.9rem"},children:"Birden fazla resim seçebilirsiniz"})]})]}),a.jsxs("div",{className:"admin-modal-actions",children:[a.jsx("button",{type:"button",onClick:()=>b(!1),className:"admin-btn-secondary",children:"İptal"}),a.jsx("button",{type:"submit",className:"admin-btn-primary",children:k?"Güncelle":"Kaydet"})]})]})]})})]})};export{g as default};

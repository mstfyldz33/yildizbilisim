import{u as e,d as a,j as s}from"./index-DuKwbuAV.js";import{r as t}from"./react-vendor-CCsTzcwv.js";import{q as i,h as n,l,j as d,v as c,p as r,e as o,x as m,f as x}from"./firebase-vendor-BOy9xtg7.js";const h=()=>{const{showToast:h}=e(),[j,p]=t.useState([]),[u,g]=t.useState(!0),[f,v]=t.useState(!1),[b,N]=t.useState(null),[y,k]=t.useState({title:"",excerpt:"",content:"",date:(new Date).toISOString().split("T")[0],icon:"fa-video"});t.useEffect(()=>{z()},[]);const z=async()=>{try{const e=i(n(a,"blog_posts"),l("created_at","desc")),s=(await d(e)).docs.map(e=>({id:e.id,...e.data()}));p(s)}catch(e){p([])}finally{g(!1)}};return u?s.jsxs("div",{className:"admin-loading",children:[s.jsx("i",{className:"fas fa-spinner fa-spin"}),s.jsx("p",{children:"Yükleniyor..."})]}):s.jsxs("div",{className:"admin-blog",children:[s.jsxs("div",{className:"admin-page-header",children:[s.jsx("h1",{children:"Blog Yönetimi"}),s.jsxs("button",{onClick:()=>{N(null),k({title:"",excerpt:"",content:"",date:(new Date).toISOString().split("T")[0],icon:"fa-video"}),v(!0)},className:"admin-btn-primary",children:[s.jsx("i",{className:"fas fa-plus"})," Yeni Blog Yazısı"]})]}),s.jsx("div",{className:"admin-table-container",children:s.jsxs("table",{className:"admin-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Başlık"}),s.jsx("th",{children:"Tarih"}),s.jsx("th",{children:"İkon"}),s.jsx("th",{children:"İşlemler"})]})}),s.jsx("tbody",{children:0===j.length?s.jsx("tr",{children:s.jsx("td",{colSpan:"4",className:"admin-empty",children:"Henüz blog yazısı yok. İlk yazınızı ekleyin!"})}):j.map(e=>s.jsxs("tr",{children:[s.jsx("td",{children:e.title}),s.jsx("td",{children:e.date}),s.jsx("td",{children:s.jsx("i",{className:`fas ${e.icon}`})}),s.jsx("td",{children:s.jsxs("div",{className:"admin-actions",children:[s.jsxs("button",{onClick:()=>(e=>{N(e),k({title:e.title,excerpt:e.excerpt,content:e.content||"",date:e.date||(new Date).toISOString().split("T")[0],icon:e.icon||"fa-video"}),v(!0)})(e),className:"admin-btn-edit",children:[s.jsx("i",{className:"fas fa-pen-to-square"})," Düzenle"]}),s.jsxs("button",{onClick:()=>(async e=>{if(confirm("Bu blog yazısını silmek istediğinizden emin misiniz?"))try{await c(r(a,"blog_posts",e)),z(),h("Blog yazısı silindi!","success")}catch(s){h("Hata: "+s.message,"error")}})(e.id),className:"admin-btn-delete",children:[s.jsx("i",{className:"fas fa-trash"})," Sil"]})]})})]},e.id))})]})}),f&&s.jsx("div",{className:"admin-modal-overlay",onClick:()=>v(!1),children:s.jsxs("div",{className:"admin-modal",onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{className:"admin-modal-header",children:[s.jsx("h2",{children:b?"Blog Yazısı Düzenle":"Yeni Blog Yazısı"}),s.jsx("button",{onClick:()=>v(!1),className:"admin-modal-close",children:s.jsx("i",{className:"fas fa-times"})})]}),s.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{const e={...y,created_at:b?void 0:o(),updated_at:o()};b?await m(r(a,"blog_posts",b.id),e):await x(n(a,"blog_posts"),e),v(!1),N(null),k({title:"",excerpt:"",content:"",date:(new Date).toISOString().split("T")[0],icon:"fa-video"}),z(),h(b?"Blog yazısı güncellendi!":"Blog yazısı eklendi!","success")}catch(s){h("Hata: "+s.message,"error")}},className:"admin-modal-form",children:[s.jsxs("div",{className:"admin-form-group",children:[s.jsx("label",{children:"Başlık *"}),s.jsx("input",{type:"text",value:y.title,onChange:e=>k({...y,title:e.target.value}),required:!0})]}),s.jsxs("div",{className:"admin-form-group",children:[s.jsx("label",{children:"Özet *"}),s.jsx("textarea",{value:y.excerpt,onChange:e=>k({...y,excerpt:e.target.value}),rows:"3",required:!0})]}),s.jsxs("div",{className:"admin-form-group",children:[s.jsx("label",{children:"İçerik"}),s.jsx("textarea",{value:y.content,onChange:e=>k({...y,content:e.target.value}),rows:"6"})]}),s.jsxs("div",{className:"admin-form-row",children:[s.jsxs("div",{className:"admin-form-group",children:[s.jsx("label",{children:"Tarih *"}),s.jsx("input",{type:"date",value:y.date,onChange:e=>k({...y,date:e.target.value}),required:!0})]}),s.jsxs("div",{className:"admin-form-group",children:[s.jsx("label",{children:"İkon (Font Awesome class)"}),s.jsx("input",{type:"text",value:y.icon,onChange:e=>k({...y,icon:e.target.value}),placeholder:"fa-video"})]})]}),s.jsxs("div",{className:"admin-modal-actions",children:[s.jsx("button",{type:"button",onClick:()=>v(!1),className:"admin-btn-secondary",children:"İptal"}),s.jsx("button",{type:"submit",className:"admin-btn-primary",children:b?"Güncelle":"Kaydet"})]})]})]})})]})};export{h as default};
